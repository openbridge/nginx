##############################################
# SSL/TLS Certificate Configuration
##############################################
ssl_certificate         /etc/letsencrypt/live/{{NGINX_SERVER_NAME}}/fullchain.pem;
ssl_certificate_key     /etc/letsencrypt/live/{{NGINX_SERVER_NAME}}/privkey.pem;
ssl_trusted_certificate /etc/letsencrypt/live/{{NGINX_SERVER_NAME}}/chain.pem;

##############################################
# SSL/TLS Protocols & Cipher Settings
##############################################
# Enable only secure protocols
ssl_protocols           TLSv1.2 TLSv1.3;

# Specify strong ciphers; the order is important for prioritizing secure algorithms
ssl_ciphers             'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:\
ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:\
ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:\
ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:\
ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';
ssl_prefer_server_ciphers on;

# Use modern elliptic curves for ECDH key exchange
ssl_ecdh_curve          X25519:secp384r1;

##############################################
# SSL/TLS Session Settings
##############################################
ssl_session_cache       shared:SSL:50m;
ssl_session_timeout     30m;
ssl_session_tickets     off;

##############################################
# Diffie-Hellman Parameters
##############################################
# Use a strong DH parameter for added security during key exchange
ssl_dhparam             /etc/pki/tls/dhparam.pem;

##############################################
# SSL Buffer Settings
##############################################
ssl_buffer_size         8k;

##############################################
# OCSP Stapling
##############################################
# Enable OCSP stapling to improve handshake speed and certificate validation
ssl_stapling            on;
ssl_stapling_verify     on;
